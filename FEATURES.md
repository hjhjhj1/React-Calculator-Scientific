# 计算历史数据分析功能

## 新增功能

### 1. 计算历史记录系统
- 自动记录所有计算操作（表达式、结果、时间戳）
- 记录计算成功/失败状态
- 记录错误类型（如语法错误、计算错误等）
- 自动识别并记录使用的数学函数
- 数据存储在浏览器 localStorage 中

### 2. 数据分析功能
- **常用函数统计**：分析用户最常使用的数学函数
- **计算频率分析**：按小时统计用户的计算习惯
- **错误类型分布**：统计各种类型的错误发生频率
- **成功率统计**：计算成功计算的百分比
- **时间分布**：按日期统计计算数量

### 3. 数据可视化（使用 Chart.js）
- **饼图**：展示常用函数分布
- **饼图**：展示错误类型分布
- **柱状图**：展示计算频率（按小时）
- 响应式图表设计
- 交互式工具提示

### 4. 时间段筛选
- 支持按开始日期和结束日期筛选数据
- 实时更新统计结果和图表
- 支持重置筛选条件

### 5. 报告导出
- **CSV 导出**：导出详细的计算历史记录
- **JSON 导出**：导出分析报告（包含统计摘要、函数使用、错误分布等）
- 自动生成带时间戳的文件名

### 6. 用户界面
- 使用 React Bootstrap Tabs 组件实现标签页切换
- "计算器"标签：原有的科学计算器功能
- "数据分析"标签：新增的数据分析仪表板
- 统计卡片展示关键指标
- 响应式布局设计

## 使用说明

1. **使用计算器**：在"计算器"标签中进行计算操作，所有计算都会自动记录
2. **查看分析**：切换到"数据分析"标签查看计算习惯分析
3. **筛选数据**：在数据分析页面选择日期范围，点击"筛选"按钮
4. **导出报告**：点击"导出CSV"或"导出JSON"按钮下载分析报告
5. **清空历史**：点击"清空历史"按钮清除所有计算记录

## 技术实现

### 新增文件
- `src/utils/calculationHistory.js`：历史记录管理和数据分析工具类
- `src/components/AnalysisDashboard.js`：数据分析可视化组件

### 修改文件
- `src/App.js`：集成历史记录功能和数据分析组件

### 依赖库
- `chart.js`：图表库
- `react-chartjs-2`：Chart.js 的 React 封装
- `react-bootstrap`：UI 组件库
- `react-icons`：图标库

## 数据结构

### 计算记录
```javascript
{
  id: Number,           // 唯一标识符
  expression: String,   // 计算表达式
  result: String,       // 计算结果
  isError: Boolean,     // 是否错误
  errorType: String,    // 错误类型（如果有）
  timestamp: String,    // 时间戳
  functionsUsed: Array  // 使用的函数列表
}
```

### 分析结果
```javascript
{
  totalCalculations: Number,      // 总计算次数
  successRate: String,            // 成功率
  functionsUsed: Object,          // 函数使用统计
  calculationFrequency: Object,   // 计算频率统计
  errorTypes: Object,             // 错误类型统计
  timeDistribution: Object        // 时间分布统计
}
```

## 示例

### 常用函数分布
- sin: 15 次
- log: 12 次
- sqrt: 8 次
- cos: 5 次

### 计算频率
- 08:00-09:00: 10 次
- 14:00-15:00: 8 次
- 16:00-17:00: 6 次

### 错误类型
- SyntaxError: 3 次
- CalculationError: 2 次

---

应用现在已成功集成数据分析功能！